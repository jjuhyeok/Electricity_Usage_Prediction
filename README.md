# Electricity_Usage_Prediction. [(Link)](https://dacon.io/competitions/official/236125/leaderboard)

## 🏆 Result
- **Public score 7th(0.3%)** 5.04758 | **Private score 22th(1%)** 6.63985



주최 : 한국에너지공단

주관 : DACON

규모 : 총 2000여명 참가

==========================================================



==========================================================
  
  

  

✏️
**대회 느낀점**
   매우 아쉬움이 남는 대회인 것 같습니다.  
 - 대회 기간이 2023/07/17부터 2023/08/28부터였는데,
   ```2023/08/01부터 2023/08/28에 욕심이 났던 수요 예측 시계열 대회가 열려 참여```하며
   전력사용량 예측 대회에 8월달부터는 거의 시도를 하지 못하였습니다.  
   만약 수요 예측 대회를 참여하지 않고,  
   꾸준히 전력사용량 예측 대회에 참여했더라면 모델을 더욱 stable하게 만들어 수상을 할 수 있었다는 생각이 듭니다.  

   전력사용량 예측 대회는 도메인을 활용해서 가설을 세우고 적용하는 방법들이 많아 흥미로웠습니다.  
   빌딩별로 빌딩유형 정보를 통해, 특정 요일에 전력이 왜 낮아지는지  
   (ex, 토요일 오전 진료인 병원 or 2,4 주차에 쉬는 대형마트)등을 EDA를 통해 구분하였고,  
   각 빌딩별로 출근, 퇴근 시간을 이용해서 파생변수를 만들어 정확도를 높여 재밌었습니다.  
   
   

============================================================

# 🚨 문제 발생과 해결 방안


<br>
===========================================================================


## Data Info
   
* train.csv  

100개 건물들의 2022년 06월 01일부터 2022년 08월 24일까지의 데이터  
일시별 기온, 강수량, 풍속, 습도, 일조, 일사 정보 포함  
전력사용량(kWh) 포함  


* building_info.csv  

100개 건물 정보  
건물 번호, 건물 유형, 연면적, 냉방 면적, 태양광 용량, ESS 저장 용량, PCS 용량  


* test.csv  
 
100개 건물들의 2022년 08월 25일부터 2022년 08월 31일까지의 데이터  
일시별 기온, 강수량, 풍속, 습도의 예보 정보  
 

---

## Process

**1. EDA** 
  * 빌딩별, 빌딩유형별, 지역별 전력 사용량 특성 확인
  * 시간별 전력 사용량 비교로 빌딩별 출근, 퇴근 시간 확인 및 쉬는 요일 파악
  * 빌딩간 day에 따른 power(ex, 대형마트는 2,4주째 일요일이 휴무일)
  * 시간 흐름에 따른 전력 사용량의 추세 파악
  
**2. Feature Engineering** 
  * 시간 feature들은 inherently cyclical 하다는 특징을 활용하기 위해 sin/cos 변환
  * 특정 피처들의 target 값의 평균으로 파생 변수 생성
  * 각 빌딩별로 출, 퇴근 시간을 계산하는 logic 을 구현하여 파생변수 생성 -> 관광지가 많은 곳은 교통량이 혼잡할 것이다 라는 가설
  * 폭염 주의보, 경보, 체감온도, 열대야, 냉방도일과 같은 온도 관련 파생변수 생성
  * 특정 시간대에 무조건 이전 시간대보다 전력 사용량이 증가 or 감소한다를 알려주는 파생변수 생성
  * 태양광 효율 파생변수 생성
  * 비가 올 때와 오지 않을 때의 전력 사용량 통계를 이용한 파생변수 생성
  * 이외의 feature engineering을 통해 총 60여개의 피처로 학습 진행

**3. Modeling**

  * XGBoostRegressor 모델 사용
  * Optuna를 활용하여 하이퍼파라미터 튜닝
  * 교차 검증 활용(stratified k-fold cross validation)
  * target 값은 정수형으로 이루어져있다는 사실에 기반하여 예측값을 round 

**추가 시도 사항** (최종 결과 도출에는 비사용)
  * IQR * 1.5 2.0 등등 값을 변화해가며 폭주 or 사고라고 생각하는 이상치들을 drop -> 정확도가 오히려 낮아짐
  * 3 sigma 법칙을 이용해 폭주 or 사고라고 생각하는 이상치들을 drop -> 정확도가 오히려 낮아짐
  * Stacking 기법 -> 마지막에 시도하였지만 시간이 부족해 base model의 충분한 하이퍼파라미터 튜닝을 하지 못해 성능이 약간 하락
    -> 대회 종료 후 다시 확인하였더니 Stacking 기법이 더 점수가 좋았음
  * 관광지 관련 파생변수 생성할 때 카카오맵 API를 사용하였는데 DataLeakage로 최종 제출에는 사용하지 않음 -> 제일 성능이 좋았음
  * 다양한 KFold K 변경


  
